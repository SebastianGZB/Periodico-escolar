{% extends 'noticias/base.html' %}

{% block contenido %}
<h1>Archivo por día</h1>

<form method="get" action="{% url 'archivo_por_dia' %}" style="margin: 12px 0 20px 0;">
  <label for="fecha">Selecciona una fecha:</label>
  <input type="date" id="fecha" name="d" value="{{ initial_value }}" />
  <button type="submit">Buscar</button>
</form>

{% if selected_date %}
  <p style="color:#666; margin-top:-6px;">Resultados para: {{ selected_date|date:"d \\de F \\de Y" }}</p>
{% endif %}

{% if error %}
  <p style="color:#a00;">{{ error }}</p>
{% endif %}

{% for noticia in noticias %}
  <article style="margin-bottom: 30px; display: grid; grid-template-columns: 180px 1fr; gap: 16px; align-items: start;">
    {% if noticia.imagen %}
      <a href="{% url 'detalle_noticia' noticia.id %}">
        <img src="{{ noticia.imagen.url }}" alt="Imagen de {{ noticia.titulo }}"
             style="width: 180px; height: 120px; object-fit: cover; border-radius: 8px;" loading="lazy">
      </a>
    {% else %}
      <div style="width: 180px; height: 120px; border-radius: 8px; background:#f0f0f0; display:flex; align-items:center; justify-content:center; color:#777; font-size:12px;">
        Sin imagen
      </div>
    {% endif %}

    <div>
      <h3 style="margin: 0 0 6px 0;">{{ noticia.titulo }}</h3>
      <p style="margin: 0 0 8px 0;">
        {{ noticia.contenido|slice:":200" }}{% if noticia.contenido|length > 200 %}...{% endif %}
      </p>
      <p style="margin: 0 0 8px 0; color:#555;">
        <strong>Categoría:</strong>
        <a href="{% url 'noticias_por_categoria' noticia.categoria.id %}">
          {{ noticia.categoria.nombre }}
        </a>
      </p>
      <a href="{% url 'detalle_noticia' noticia.id %}" style="color:#007bff; text-decoration:none; font-weight:bold;">Leer más →</a>
    </div>
  </article>
  <hr>
{% empty %}
  {% if selected_date %}
    <p>No hay noticias en la fecha seleccionada.</p>
  {% endif %}
{% endfor %}

<p style="margin-top: 16px;">
  <a href="{% url 'archivo_ediciones' %}">← Volver al archivo de ediciones</a>
</p>
{% endblock %}
